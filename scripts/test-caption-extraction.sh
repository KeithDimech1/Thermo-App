#!/bin/bash
# Demonstration script for caption extraction functionality

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Caption Extraction Script Demo"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "This script demonstrates the updated caption extraction workflow:"
echo ""
echo "âœ… FEATURES:"
echo "  1. Extract figure captions from plain-text.txt"
echo "  2. Match captions to images (filter by size)"
echo "  3. RENAME image files to use figure names"
echo "     Example: page_4_img_0.jpeg â†’ figure_1.jpeg"
echo "  4. Extract table captions from plain-text.txt"
echo "  5. Create table-metadata.json with full captions"
echo ""
echo "ğŸ“¦ OUTPUT FILES:"
echo "  - images/image-metadata.json (updated with renamed files + captions)"
echo "  - images/image-metadata.backup.json (backup of original)"
echo "  - images/table-metadata.json (NEW: table captions)"
echo "  - images/figure_*.{jpeg|png} (renamed image files)"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“– USAGE:"
echo ""
echo "  npx tsx scripts/extract-figure-captions.ts \\"
echo "    text/plain-text.txt \\"
echo "    images/image-metadata.json"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ’¡ INTEGRATION IN /thermoanalysis:"
echo ""
echo "  This is now STEP 7.7 in the /thermoanalysis workflow."
echo "  After extracting images from PDF (STEP 7), run this script"
echo "  to filter, rename, and extract table metadata."
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Show script location
SCRIPT_PATH="scripts/extract-figure-captions.ts"
if [ -f "$SCRIPT_PATH" ]; then
    echo "âœ… Script found: $SCRIPT_PATH"
    echo ""
    echo "Lines of code: $(wc -l < "$SCRIPT_PATH")"
    echo ""
else
    echo "âŒ Script not found: $SCRIPT_PATH"
    exit 1
fi

echo "ğŸ¯ KEY IMPROVEMENTS:"
echo ""
echo "  BEFORE:"
echo "    - Images: page_4_img_0.jpeg, page_7_img_1.jpeg (hard to identify)"
echo "    - No table captions (only screenshot files)"
echo "    - Logos and small graphics mixed with figures"
echo ""
echo "  AFTER:"
echo "    - Images: figure_1.jpeg, figure_2.jpeg (clear identification)"
echo "    - Table captions in searchable JSON"
echo "    - Only scientifically relevant figures kept"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âœ¨ Ready to use! Run the command above in your paper directory."
echo ""
